<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API ì—°ê²° í…ŒìŠ¤íŠ¸</title>
    
    <!-- API ì„¤ì • -->
    <script src="js/api-config.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f4f9;
            line-height: 1.6;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #1976d2;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #fafafa;
        }
        
        .test-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        button {
            background: linear-gradient(135deg, #1976d2, #64b5f6);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        button:hover {
            background: linear-gradient(135deg, #1565c0, #42a5f5);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }
        
        .error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        
        .info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1565c0;
        }
        
        .status {
            text-align: center;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            font-weight: 600;
        }
        
        .status.connected {
            background: #e8f5e8;
            color: #2e7d32;
        }
        
        .status.disconnected {
            background: #ffebee;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”— API ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
        
        <!-- í´ë¼ìš°ë“œ ì„œë²„ ì •ë³´ -->
        <div class="test-section">
            <h3>â˜ï¸ í´ë¼ìš°ë“œ ì„œë²„ ì •ë³´</h3>
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <p><strong>ì„œë²„ URL:</strong> <code>${API_CONFIG.BASE_URL}</code></p>
                <p><strong>API í‚¤:</strong> <code>${API_CONFIG.API_KEY.substring(0, 20)}...</code></p>
                <p><strong>ìƒíƒœ:</strong> <span id="apiKeyStatus">âœ… API í‚¤ ì„¤ì •ë¨</span></p>
            </div>
        </div>
        
        <div id="connectionStatus" class="status disconnected">
            í´ë¼ìš°ë“œ ì„œë²„ ì—°ê²° ìƒíƒœ í™•ì¸ ì¤‘...
        </div>
        
        <!-- ì„œë²„ ìƒíƒœ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸŒ ì„œë²„ ìƒíƒœ í™•ì¸</h3>
            <button onclick="testServerHealth()">ì„œë²„ ìƒíƒœ í™•ì¸</button>
            <div id="healthResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- ì¸ì¦ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ” ì¸ì¦ í…ŒìŠ¤íŠ¸</h3>
            <div class="form-group">
                <label for="testUsername">ì‚¬ìš©ìëª…:</label>
                <input type="text" id="testUsername" value="testuser" placeholder="í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìëª…">
            </div>
            <div class="form-group">
                <label for="testPassword">ë¹„ë°€ë²ˆí˜¸:</label>
                <input type="password" id="testPassword" value="testpass123" placeholder="í…ŒìŠ¤íŠ¸ìš© ë¹„ë°€ë²ˆí˜¸">
            </div>
            <button onclick="testRegister()">íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸</button>
            <button onclick="testLogin()">ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</button>
            <button onclick="testLogout()">ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸</button>
            <div id="authResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- ê²¬ì ì„œ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“‹ ê²¬ì ì„œ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testCreateQuote()">ê²¬ì ì„œ ìƒì„± í…ŒìŠ¤íŠ¸</button>
            <button onclick="testGetQuotes()">ê²¬ì ì„œ ëª©ë¡ ì¡°íšŒ</button>
            <div id="quoteResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- ì œí’ˆ ì •ë³´ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“¦ ì œí’ˆ ì •ë³´ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testGetCategories()">ì œí’ˆ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ</button>
            <button onclick="testSearchProducts()">ì œí’ˆ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
            <div id="productResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testAdminDashboard()">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</button>
            <button onclick="testSystemStatus()">ì‹œìŠ¤í…œ ìƒíƒœ</button>
            <div id="adminResult" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„œë²„ ì—°ê²° ìƒíƒœ í™•ì¸
        document.addEventListener('DOMContentLoaded', async () => {
            await checkServerConnection();
        });
        
        // ì„œë²„ ì—°ê²° ìƒíƒœ í™•ì¸ (í´ë¼ìš°ë“œ ì„œë²„)
        async function checkServerConnection() {
            const statusDiv = document.getElementById('connectionStatus');
            try {
                // ì§ì ‘ /health ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ (API ê²½ë¡œê°€ ì•„ë‹˜)
                const response = await fetch('http://localhost:3000/health');
                if (response.ok) {
                    statusDiv.textContent = 'âœ… ì„œë²„ ì—°ê²° ì„±ê³µ';
                    statusDiv.className = 'status connected';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusDiv.textContent = 'âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨ - ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”';
                statusDiv.className = 'status disconnected';
            }
        }
        
        // ì„œë²„ ìƒíƒœ í™•ì¸
        async function testServerHealth() {
            const resultDiv = document.getElementById('healthResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...';
            
            try {
                const response = await fetch('http://localhost:3000/health');
                const data = await response.json();
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸
        async function testRegister() {
            const resultDiv = document.getElementById('authResult');
            const username = document.getElementById('testUsername').value;
            const password = document.getElementById('testPassword').value;
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'íšŒì›ê°€ì… ì¤‘...';
            
            try {
                const response = await apiService.post(API_CONFIG.ENDPOINTS.AUTH.REGISTER, {
                    username: username,
                    email: `${username}@test.com`,
                    password: password,
                    profile: {
                        name: 'í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì',
                        phone: '010-1234-5678'
                    }
                });
                
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
        async function testLogin() {
            const resultDiv = document.getElementById('authResult');
            const username = document.getElementById('testUsername').value;
            const password = document.getElementById('testPassword').value;
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ë¡œê·¸ì¸ ì¤‘...';
            
            try {
                const response = await apiService.post(API_CONFIG.ENDPOINTS.AUTH.LOGIN, {
                    username: username,
                    password: password
                });
                
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸
        async function testLogout() {
            const resultDiv = document.getElementById('authResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ë¡œê·¸ì•„ì›ƒ ì¤‘...';
            
            try {
                const response = await apiService.post(API_CONFIG.ENDPOINTS.AUTH.LOGOUT);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ê²¬ì ì„œ ìƒì„± í…ŒìŠ¤íŠ¸
        async function testCreateQuote() {
            const resultDiv = document.getElementById('quoteResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ê²¬ì ì„œ ìƒì„± ì¤‘...';
            
            try {
                const quoteData = {
                    customer: {
                        name: 'í…ŒìŠ¤íŠ¸ ê³ ê°',
                        phone: '010-1234-5678',
                        address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬'
                    },
                    salesPerson: 'í…ŒìŠ¤íŠ¸ ë‹´ë‹¹ì',
                    salesPhone: '010-9876-5432',
                    quoteDate: new Date().toISOString().split('T')[0],
                    validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    description: 'í…ŒìŠ¤íŠ¸ ê²¬ì ì„œì…ë‹ˆë‹¤.',
                    products: [
                        {
                            name: 'ì •ìˆ˜ê¸°',
                            model: 'CUCKOO-001',
                            rentalFee: 50000,
                            usagePeriod: 24,
                            contractPeriod: 24,
                            quantity: 1,
                            total: 50000
                        }
                    ],
                    totalAmount: 50000,
                    status: 'draft',
                    notes: 'API í…ŒìŠ¤íŠ¸ìš© ê²¬ì ì„œ'
                };
                
                const response = await apiService.post(API_CONFIG.ENDPOINTS.QUOTES.CREATE, quoteData);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ê²¬ì ì„œ ëª©ë¡ ì¡°íšŒ í…ŒìŠ¤íŠ¸
        async function testGetQuotes() {
            const resultDiv = document.getElementById('quoteResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ê²¬ì ì„œ ëª©ë¡ ì¡°íšŒ ì¤‘...';
            
            try {
                const response = await apiService.get(API_CONFIG.ENDPOINTS.QUOTES.LIST);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ì œí’ˆ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ í…ŒìŠ¤íŠ¸
        async function testGetCategories() {
            const resultDiv = document.getElementById('productResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ì œí’ˆ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ ì¤‘...';
            
            try {
                const response = await apiService.get(API_CONFIG.ENDPOINTS.PRODUCTS.CATEGORIES);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ì œí’ˆ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
        async function testSearchProducts() {
            const resultDiv = document.getElementById('productResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ì œí’ˆ ê²€ìƒ‰ ì¤‘...';
            
            try {
                const response = await apiService.post(API_CONFIG.ENDPOINTS.PRODUCTS.SEARCH, {
                    query: 'ì •ìˆ˜ê¸°',
                    category: 'water-purifier'
                });
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ í…ŒìŠ¤íŠ¸
        async function testAdminDashboard() {
            const resultDiv = document.getElementById('adminResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì¡°íšŒ ì¤‘...';
            
            try {
                const response = await apiService.get(API_CONFIG.ENDPOINTS.ADMIN.DASHBOARD);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
        
        // ì‹œìŠ¤í…œ ìƒíƒœ í…ŒìŠ¤íŠ¸
        async function testSystemStatus() {
            const resultDiv = document.getElementById('adminResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ì‹œìŠ¤í…œ ìƒíƒœ ì¡°íšŒ ì¤‘...';
            
            try {
                const response = await apiService.get(API_CONFIG.ENDPOINTS.ADMIN.SYSTEM_STATUS);
                resultDiv.className = 'result success';
                resultDiv.textContent = JSON.stringify(response, null, 2);
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `ì˜¤ë¥˜: ${error.message}`;
            }
        }
    </script>
</body>
</html> 